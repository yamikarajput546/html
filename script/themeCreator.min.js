function sleep(e){return new Promise(t=>setTimeout(t,e))}function eventListener(){const e=document.querySelector(".layers"),t=document.querySelector(".properties"),s=document.getElementById("add-layer"),i=document.getElementById("delete-layer"),n=document.getElementById("up-layer"),o=document.getElementById("down-layer"),l=document.querySelector(".exitButton"),a=document.querySelector(".copyCode"),r=document.getElementById("create-button"),c=new UI;e.addEventListener("click",function(e){e.preventDefault()}),t.addEventListener("submit",function(e){e.preventDefault(),c.submitProperties()}),s.addEventListener("click",function(e){e.preventDefault(),c.showAddProperties()}),i.addEventListener("click",function(e){e.preventDefault(),c.deleteSection()}),n.addEventListener("click",function(e){e.preventDefault(),c.upSection()}),o.addEventListener("click",function(e){e.preventDefault(),c.downSection()}),l.addEventListener("click",function(e){e.preventDefault(),c.closeProperties()}),r.addEventListener("click",function(e){e.preventDefault(),c.controlTemplateSettings()}),a.addEventListener("click",function(e){e.preventDefault(),c.copyCode()})}function Section(e,t,s,i,n){this.idName=e,this.className=t,this.max_widgets=s,this.show_add_element=i,this.widgetType=n}function CSSattr(e,t,s,i){this.selectorName=e,this.width=t,this.height=s,this.bgColor=i}function uniqueIDcontrol(e){if(0===sections.length)return!0;for(var t=0;t<sections.length;t++)if(sections[t].idName===e)return!1;return!0}function controlCSS(e){for(var t=0;t<cssStyles.length;t++)if(e.selectorName==cssStyles[t].selectorName)return cssStyles[t]=e,!1;return!0}function randomCharacter(e){for(var t="",s=["A","a","B","b","C","c","D","d","E","e","F","f","G","g","H","h","I","i","J","j","K","k","L","l","M","m","N","n","O","o","P","p","Q","q","R","r","S","s","T","t","U","u","V","v","W","w","X","x","Y","y","Z","z"],i=0;i<e;i++){var n=Math.floor(Math.random()*s.length);t+=s[n]}return t}function titlePattern(e){return"&lt;title&gt;"+e+"&lt;/title&gt;"}function cssPattern(e,t,s,i){return"."+e+"-area{width:"+t+";height:"+s+";background:"+i+";}"+newLine+tab}function sectionPattern(e,t,s,i,n){return"0"===n&&"1"!==n?newLine+tab+"&lt;div class='"+t+"-area'><br/>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&lt;b:section id='"+e+"' class='"+t+"' maxwidgets='"+s+"' showaddelement='"+i+"'/>"+newLine+tab+"&lt;/div&gt;":"1"===n?newLine+tab+"&lt;div class='"+t+"-area'><br/>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&lt;b:section id='"+e+"' class='"+t+"' maxwidgets='"+s+"' showaddelement='"+i+"'>"+newLine+tab+tab+main_widget+newLine+tab+"&emsp;&emsp;&lt;/b:section&gt;"+newLine+tab+"&lt;/div&gt;":void 0}class UI{constructor(){this.controller=document.querySelector(".controller"),this.panel=document.querySelector(".panel"),this.demoView=document.querySelector(".demo-view"),this.codeBox=document.querySelector(".codeBox"),this.codeBox.style.display="none",this.copyCodeButton=document.querySelector(".copyCode"),this.copyCodeButton.style.display="none",this.templateName=document.getElementById("templateName"),this.templateURL=document.getElementById("templateURL"),this.author=document.getElementById("author"),this.settingsNotification=document.querySelector(".settings-notification"),this.rightside=document.querySelector(".rightside"),this.layersList=document.querySelector(".layers-list"),this.layersControl=document.querySelector(".layers-control"),this.properties=document.querySelector(".properties"),this.propertiesNotification=document.querySelector(".properties-notification"),this.sectionId=document.getElementById("sectionId"),this.sectionClass=document.getElementById("sectionClass"),this.maxWidgetNumber=document.getElementById("maxWidgetNumber"),this.selectBox=document.getElementById("select_box"),this.selectWidgetType=document.getElementById("select_widget_type"),this.sectionOption=document.querySelector(".sectionOption"),this.line=document.createElement("hr"),this.temp_msg,this.securityCode=randomCharacter(10),this.canvas=document.getElementById("preview"),this.context=this.canvas.getContext("2d"),this.image=new Image}submitProperties(){const e=this.sectionId.value,t=this.sectionClass.value,s=this.maxWidgetNumber.value,i=this.selectBox.options[this.selectBox.selectedIndex].value,n=this.selectWidgetType.options[this.selectWidgetType.selectedIndex].value,o=this;var l;if(""===e||e<0)l="Actually, section id is necessary.";else if(""===t||t<0)l="Actually, section class is necessary.";else if(""===s||s<0)l="Don't Necessary";else if("0"===i)l="Yes or No, choose one.";else if(uniqueIDcontrol(e)){l="All added.";var a=new Section(e,t,s,i,n);sections.push(a),this.addSection(o,sections),this.addOption(o,sections)}else l="ID must be unique";this.addNotification(o,l,o.propertiesNotification)}showAddProperties(){this.properties.style.display="block"}copyCode(){if(document.selection){var e=document.body.createTextRange(),t=document.getElementById("codeB");e.moveToElementText(t),e.select(),document.execCommand("copy")}else if(window.getSelection){var s=window.getSelection();s.removeAllRanges();e=document.createRange();e.selectNode(document.getElementById("codeB")),s.addRange(e),document.execCommand("copy"),s.removeAllRanges()}}addNotification(e,t,s){var i=document.createElement("div");i.className="showNotification",0!==s.children.length&&this.temp_msg===t||s.appendChild(i),i.innerHTML=t,this.temp_msg=t,setTimeout(function(){i.remove("showNotification")},1e4)}showSectionProperties(e,t,s){var i,n=t,o=document.getElementById(n),l=document.getElementById(s);if("block"===o.style.display)o.style.display="none",l.style.backgroundImage="url(https://gurb.github.io/open-arrow.png)",l.style.opacity=.5;else for(var a=0;a<sections.length;a++){var r=sections[a].idName+this.securityCode+"-option",c=sections[a].idName+this.securityCode+"-icon";t==r?(l.style.backgroundImage="url(https://gurb.github.io/close-arrow.png)",l.style.opacity=1,o.style.display="block",i=a):(document.getElementById(r).style.display="none",document.getElementById(c).style.backgroundImage="url(https://gurb.github.io/open-arrow.png)",document.getElementById(c).style.opacity=.5)}this.layersList.options[i].selected="selected"}addSection(e,t){var s=document.createElement("div"),i=document.createElement("div"),n=document.createElement("div"),o=document.createElement("span");s.className="sectionArea",n.className="sectionHeader",o.className="iconImage",i.className="sectionOption",s.id=t[t.length-1].idName+this.securityCode,i.id=t[t.length-1].idName+this.securityCode+"-option",o.id=t[t.length-1].idName+this.securityCode+"-icon";var l=t[t.length-1].idName+this.securityCode+"-option",a=o.id;i.style.display="none",n.addEventListener("click",function(){e.showSectionProperties(e,l,a)}),e.codeBox.style.display="none",e.copyCodeButton.style.display="none",e.demoView.appendChild(s),s.appendChild(n),n.appendChild(o),o.innerHTML+=t[t.length-1].idName,s.appendChild(i),this.addOptionFormSection(e,i,n)}addOptionFormSection(e,t,s){var i=document.createElement("form");i.setAttribute("class","formOptions"),i.setAttribute("method","post");var n=document.createElement("input");n.setAttribute("type","text"),n.setAttribute("class","form-control"),n.setAttribute("placeholder","Width");var o=document.createElement("input");o.setAttribute("type","text"),o.setAttribute("class","form-control"),o.setAttribute("placeholder","Height");var l=document.createElement("input");l.setAttribute("type","text"),l.setAttribute("placeholder","Font Size");var a=document.createElement("input");a.setAttribute("type","color"),a.setAttribute("class","bgColorPicker form-control"),a.setAttribute("name","Color Picker"),a.setAttribute("placeholder","Background Color"),a.setAttribute("style","padding:0;");var r=document.createElement("input");r.setAttribute("type","text"),r.setAttribute("class","bgColorPickerText form-control"),r.setAttribute("placeholder","Color code"),r.value=a.value;var c=document.createElement("input");c.setAttribute("type","submit"),c.setAttribute("value","Add Style"),c.setAttribute("class","btn btn-success");var d=document.createElement("div");d.className="form-group";var m=document.createElement("div");m.className="form-group";var u=document.createElement("div");u.className="rightInput";var p=document.createElement("div");p.className="rightInput";var h=document.createElement("div");h.className="leftInput";var y=document.createElement("div");y.className="leftInput",t.appendChild(i),i.appendChild(d).appendChild(h).appendChild(n),d.appendChild(u).appendChild(o),i.appendChild(m).appendChild(y).appendChild(r),y.appendChild(a),i.appendChild(c),e.setOptionFormValues(e,i,n,o,r,s),e.changeColor(e,a,r)}setOptionFormValues(e,t,s,i,n,o){t.addEventListener("submit",function(t){t.preventDefault();var l=s.value,a=i.value,r=n.value,c=new CSSattr(o.textContent,l,a,r);controlCSS(c)&&cssStyles.push(c),e.drawOptionFormValues(e,l,a,r)})}drawOptionFormValues(e,t,s,i){var n=e.context;n.font="12px Roboto",n.color="#ffffff",n.clearRect(0,0,e.canvas.width,e.canvas.height),console.log(i),n.fillStyle=i,n.fillRect(20,10,260,20),n.fillStyle="#ffffff",n.fillText("layer",25,20)}changeColor(e,t,s){t.addEventListener("change",function(e){e.preventDefault(),s.value=t.value})}addOption(e,t){var s=document.createElement("option");e.layersList.appendChild(s),s.innerHTML=t[t.length-1].idName}deleteSection(){sections.splice(this.layersList.selectedIndex,1);var e=this.layersList.options[this.layersList.selectedIndex].text+this.securityCode,t=document.getElementById(e);this.demoView.removeChild(t),this.layersList.remove(this.layersList.selectedIndex)}upSection(){var e=this.layersList.options[this.layersList.selectedIndex].text;this.layersList.options[this.layersList.selectedIndex].text=this.layersList.options[this.layersList.selectedIndex-1].text,this.layersList.options[this.layersList.selectedIndex-1].text=e;var t=sections[this.layersList.selectedIndex];sections[this.layersList.selectedIndex]=sections[this.layersList.selectedIndex-1],sections[this.layersList.selectedIndex-1]=t;var s=this.layersList.options[this.layersList.selectedIndex-1].text+this.securityCode,i=this.layersList.options[this.layersList.selectedIndex].text+this.securityCode,n=document.getElementById(s),o=document.getElementById(i),l=o.parentNode;l.insertBefore(n,o),this.layersList.options[this.layersList.selectedIndex-1].selected="selected"}downSection(){var e=this.layersList.options[this.layersList.selectedIndex].text;this.layersList.options[this.layersList.selectedIndex].text=this.layersList.options[this.layersList.selectedIndex+1].text,this.layersList.options[this.layersList.selectedIndex+1].text=e;var t=sections[this.layersList.selectedIndex];sections[this.layersList.selectedIndex]=sections[this.layersList.selectedIndex+1],sections[this.layersList.selectedIndex+1]=t;var s=this.layersList.options[this.layersList.selectedIndex+1].text+this.securityCode,i=this.layersList.options[this.layersList.selectedIndex].text+this.securityCode,n=document.getElementById(s),o=document.getElementById(i),l=o.parentNode;l.insertBefore(o,n),this.layersList.options[this.layersList.selectedIndex+1].selected="selected"}closeProperties(){this.properties.style.display="none"}generateCode(){const e="Template Name: "+this.templateName.value+newLine+tab,t="Template URL: "+this.templateURL.value+newLine+tab,s="Author: "+this.author.value,i=this;i.codeBox.style.display="block",i.copyCodeButton.style.display="block",i.codeBox.innerHTML=firstPattern.toString()+titlePattern("Blog")+cssFirstTag,i.codeBox.innerHTML+=commentFirst+e+t+s+commentLast;for(var n=0;n<cssStyles.length;n++)i.codeBox.innerHTML+=cssPattern(cssStyles[n].selectorName,cssStyles[n].width,cssStyles[n].height,cssStyles[n].bgColor);i.codeBox.innerHTML+=cssEndTag+headEndTag+bodyFirstTag;for(n=0;n<sections.length;n++)i.codeBox.innerHTML+=sectionPattern(sections[n].idName,sections[n].className,sections[n].max_widgets,sections[n].show_add_element,sections[n].widgetType);i.codeBox.innerHTML+=bodyEndTag+htmlEndTag}controlTemplateSettings(){const e=this.templateName.value,t=this.templateURL.value,s=this.author.value;var i;""===e?i="Give a name for template":""===t?i="Give a template URL":""==s?i="Specify template developer's name":(i="Created Successfully Template Code",this.generateCode()),this.addNotification(self,i,this.settingsNotification)}}document.addEventListener("DOMContentLoaded",function(){eventListener()});var sections=[],cssStyles=[],newLine="<br/>",tab="&emsp;&emsp;&emsp;&emsp;",XMLpattern="",firstPattern="&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&emsp;&emsp;&lt;head&gt;<br/>&emsp;&emsp;&emsp;&emsp;&lt;meta charset='utf-8'/&gt;"+newLine+tab,cssFirstTag=newLine+tab+"&lt;b:skin&gt;&lt;![CDATA["+newLine+newLine+tab,commentFirst="*/ ---------------------------------"+newLine+tab,commentLast=newLine+tab+"--------------------------------- */"+newLine+tab,cssEndTag=newLine+tab+"]]&gt;&lt;/b:skin&gt;<br/>&emsp;&emsp;",headEndTag="&lt;/head&gt;<br/>&emsp;&emsp;",bodyFirstTag="&lt;body&gt;"+newLine+tab,bodyEndTag="<br/>&emsp;&emsp;&lt;/body&gt;",htmlEndTag="<br/>&lt;/html&gt;",main_widget="&lt;b:widget id='Blog1' locked='true' title='Blog Posts' type='Blog'/&gt;";